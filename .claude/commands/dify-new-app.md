# dify-new-app（新しいアプリを作成）

⚠️ **[重要] このコマンドは以下のSkillに統合されました：**

> **新しいSkill: [`managing-dify-apps`](./../skills/managing-dify-apps/SKILL.md)**
>
> Agent-Skillsベストプラクティスに準拠した新構造です。
> より効率的で柔軟な操作が可能になりました。
>
> **推奨**: 新しいSkillの使用をお勧めします。このコマンドは後方互換性のため保持されます。

---

**ClaudeCodeが自動でDifyアプリを作成します。ユーザーは「どんなアプリを作りたいか」説明するだけです。**

---

## ユーザーに確認すること

以下の情報を、ユーザーの説明から聞き出してください：

### 1. アプリの種類（次のいずれか）

- **Q&Aチャットボット**（推奨：よく使われる）- 顧客サポート、よくある質問など
- **ワークフロー**（複数ステップ処理）- テキスト分析、データ処理など
- **複雑な判定**（条件分岐）- 振り分け、判定ロジックなど
- **API連携**（外部サービス）- 検索、データ取得など

### 2. アプリの目的

何をするアプリなのか、**日本語で詳しく説明**してもらってください。

例：
- 「顧客からの問い合わせに自動で答えるチャットボット」
- 「ユーザーの感情を判定して、対応を変える」
- 「テキストを要約する」

### 3. 入力・出力

- **入力**：アプリに何を入れるのか（テキスト、データなど）
- **出力**：アプリから何が返ってくるのか（回答、判定結果など）

---

## エージェントの実行内容

以下をすべて自動実行します：

### ステップ1：情報を整理

ユーザーの説明から以下を整理：
- アプリの種類
- 目的
- 入力・出力スキーマ

### ステップ2：適切なテンプレートを選択

| 種類 | テンプレート |
|------|-----------|
| Q&Aチャットボット | `1_simple_chatbot.dsl.yml` |
| シンプルなワークフロー | `2_echo_workflow.dsl.yml` |
| 標準ワークフロー（LLM） | `3_llm_workflow.dsl.yml` |
| 複雑な判定 | `4_conditional_workflow.dsl.yml` |
| API連携 | `5_http_api_workflow.dsl.yml` |

### ステップ3：YAML（アプリの設定）を生成

テンプレートをカスタマイズして、新しい `app.dsl.yml` を作成：
- アプリ名、説明を設定
- プロンプト（指示文）を生成
- 入出力スキーマを設定

### ステップ4：検証

```bash
docker compose run --rm dify-creator validate --dsl app.dsl.yml
```

### ステップ5：Difyに登録

```bash
docker compose run --rm dify-creator import --dsl app.dsl.yml
```

**app_id をユーザーに表示**（後で使う）

### ステップ6：テスト実行

```bash
docker compose run --rm dify-creator sync \
  --dsl app.dsl.yml \
  --app-id <返ってきたapp_id> \
  --inputs-json examples/inputs.json
```

### ステップ7：結果をユーザーに表示

`artifacts/run_result.json` の結果を要約して表示。

---

## 完了後

以下が可能になります：

- `/dify-edit-app` でアプリを修正
- `/dify-sync` で最新バージョンをテスト
- Dify のウェブサイトで公開（本番環境に出す）

---

## 注意点

- アプリの説明は詳しくしてください。詳しいほど良いYAMLが生成されます
- 複雑な要件は、まずシンプルな版を作ってから拡張することをお勧めします
- テスト実行後、結果を確認して修正が必要な場合は `/dify-edit-app` を使用
